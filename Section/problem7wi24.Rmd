---
title: "Problem Section 7"
date:  "Monday Feb 26 2024"
graphics: yes
output: pdf_document
header-includes:
    - \usepackage{amsmath, amssymb}
    - \usepackage{framed}\definecolor{shadecolor}{rgb}{0.949,0.949,0.949}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

\begin{shaded}

\textbf{Learning Outcomes}

The problems are designed to build conceptual understanding and problem-solving skills. The emphasis is on learning to find, evaluate and build confidence. The specific tasks include: 

   - Calculate one and two-sided P-values 
   
   - Find the Type I and Type II errors for a given decision rule
   
   - Find an empirical P-value
   
   - Back up and support work with relevant explanations


\end{shaded}


* * *

### Exercises 

1. A children's game uses a six sided die with a picture of a ghost named Hugo on one side and numbers on the other sides. If the die is fair, the ghost should be rolled 1/6 of the time. You test the die by rolling it $n=10$ times and and the ghost is rolled $x=3$ times.  Calculate the P-value for an exact binomial test of the hypothesis
$$H_0: \pi = \frac{1}{6} \ \ \ H_1: \pi \neq \frac{1}{6}$$

2. As input for a new inflation model, economists
predicted that the average cost of a hypothetical "food
basket" in western WA in July would be \$145.75. The
standard deviation ($\sigma_0$) of basket prices was assumed to be
$9.50, a figure that has held fairly constant over the years.
To check their prediction, a sample of twenty-five baskets
representing different parts of the region were checked in
late July, and the average cost was \$149.75. 

a. Let $\mu_0$ denote the true mean price of the food basket in July in Western WA. Write the null and alternative hypothesis.

b. Suppose the test will be based on $\bar{X}$ the sample mean. What is its sampling distribution?  (You may assume the CLT applies)

c. Calculate the P-value associated with $\bar{x} = \$149.75$. 

3. An experimenter takes a sample of size 4 - $X_1, X_2, X_3,X_4$ - from
the Poisson probability model, 
$$f(x) = e^{-\lambda_0} \frac{\lambda_0^{x}}{x!} \ \ \ x=0,1,2, \dots$$
 and wishes to test
$H0: \lambda_0 = 6$ versus $H_1: \lambda_0 < 6$. The test will be based on the statistic $S = X_1+X_2+X_3+X_4$. 

   a. Find the P-value associated with observing $s_{obs} = 15$. 
   
   b. Suppose we decide to conduct the test at level $\alpha = 0.1$. What values of $s_{obs}$ will you reject $H_0$ for?

   a. Find the Type I error rate for your test in part b.
   
   d. Calculate the Type II error rate for your test in part b. when $\lambda_0 = 4$. 
   

4.  Suppose the following sample - denoted by $X_1,X_2,\dots,X_n$ - are drawn from a $Norm(0, \sigma^2_0)$ distribution:

    ```{r}
    sample_df <- tibble( 
            x= c(-0.58319935, -1.36090219,  0.38663763, -1.54365592,  
                 0.87083945, -0.69187830, 0.45898841, -2.82556635,  
                 0.01777137, -0.62753863 , 0.54611381, -1.39731591, 
                 -1.72584231,  0.91371529,  0.18096064, -0.53063107, 
                 -0.76604739, -1.97107704, 0.56394712,  1.13707563))
    ```

    We want to test $H_0: \sigma^2_0 = 1$ versus $\sigma^2_0 > 1$ using the sample variance:
$$S^2 = \frac{1}{n-1} \sum\limits_{i=1}^{n} (X_i - \bar{X})^2$$ as our test statistic.

a. Calculate $s^2_{obs}$, the observed value of the estimator $S^2$. Save it in a variable called `obs_s2`.  

```{r}
# calculate obs_s2, the observed value for S^2

```

b. Simulate the sampling distribution of $S^2$ under the null hypothesis. This means generate a new $x$ assuming the null hypothesis is true and calculate $s^2$ for each such dataset. Fill in blanks in the code below and then remove the `eval=F` chunk option when knitting.

```{r label="gen-null-dist", eval = F}
set.seed(2626)                       #random number seed
B <- 1000                            # number of replications
nsamp <- ___                         # sample size n 
sigma2_null <- ___                   #null value

#repeatedly sample from a Norm(0,sigma2null) and calculate the 
#sample variance s2star from each sample
null_sim_df <- tibble(
                s2star = replicate(n = ___, expr = ___)
)



```


c. Make a histogram of the values of `s2star` you have simulated under the null hypothesis, and mark the observed value with a vertical line. 

```{r}

```


 
d. Calculate the empirical P-value. (Hint: $S^2$ is an unbiased estimator of the true value of $\sigma_0^2$. Based on this fact, do large values, small values or both large and small values support $H_1$?) 

```{r}


```

